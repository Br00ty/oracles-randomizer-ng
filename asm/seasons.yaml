addrs:
  # hram
  hMusicVar: 0xffb5 # used in filterMusic

  # wram
  wActiveRing: 0xc6c5
  wActiveGroup: 0xcc49
  wActiveRoom: 0xcc4c
  wAreaFlags: 0xcc50
  wActiveTileType: 0xccb6

  # rom 00
  playSound: 0x0c74
  refillSeedSatchel: 0x17e5
  forceEnableIntroInputs: 0x0862

  # rom 02
  _closeMenu: 0x4f7b

  # rom 3f
  giveTreasure_body: 0x44c8

banks:
  0x00:
  # call a function hl in bank 02, preserving af. e can't be used as a
  # parameter to that function, but it can be returned.
  - callBank2: |
      push af
      ld e,02
      call interBankCall
      pop af
      ret

  # increment hl until (hl) equals either register a or ff. returns z if
  # a match was found.
  - searchValue: |
      push bc
      ld b,a
      ldi a,(hl)
      cp b
      jr z,06
      inc a
      jr z,02
      jr f7
      inc a
      ld a,b
      pop bc
      ret

  # search for a key bc in a dictionary starting at hl. the dictionary is
  # a series of two-byte keys and two-byte values. if a match is found,
  # hl is the address of the value, and z is set. the dictionary ends
  # when $ff is encountered at the beginning of an entry.
  - lookupWord: |
      ldi a,(hl)
      cp a,ff
      jr nz,02
      or a
      ret
      cp b
      ldi a,(hl)
      jr nz,02
      cp c
      ret z
      inc hl
      inc hl
      jr ef

  0x01:
  # takes b = high byte of season addr, returns season in b.
  - readDefaultSeason: |
      ld h,7e
      ld l,b
      ld a,(hl)
      ld b,a
      ret

  0x02:
  # warp to ember tree if holding start when closing the map screen.
  - treeWarp: |
      # close as normal if start not held
      ld a,(wKeysPressed)
      and a,08
      jr z,16
      # if indoors, play error sound and ret
      ld a,(wAreaFlags)
      and a,01
      jr nz,06
      ld a,5a
      jp playSound
      # close + warp
      ld hl,cbb7
      ld (hl),05
      xor a
      call 5e7b
      jp _closeMenu

  0x07:
  # if wearing dev ring, change season regardless of where link is standing.
  - devChangeSeason: |
      ld a,(wActiveRing)
      cp a,40
      ret z
      ld a,(wActiveTileType)
      cp a,08
      ret

  0x0b:
  # custom script command to use on d1 entrance screen: set ccaa to 01 until
  # bit of cfc0 is set. fixes a vanilla bug where dismounting an animal on
  # that screen allowed you to enter without the key.
  - d1EntranceScriptCmd: |
      pop hl
      ld a,(wActiveGroup)
      cp a,00
      ret nz
      ld a,(wActiveRoom)
      cp a,96
      ret nz
      ld a,01
      ld (ccaa),a
      xor a
      jp 432d

  0x3f:
  # have seed satchel inherently refill all seeds.
  - satchelRefillSeeds: |
      push bc
      call giveTreasure_body
      ld a,b
      pop bc
      push af
      ld a,b
      cp a,19
      jr nz,07
      push bc
      push de
      call refillSeedSatchel
      pop de
      pop bc
      pop af
      ld b,a
      ret
